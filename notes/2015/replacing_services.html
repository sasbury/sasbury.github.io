<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>sasbury.com</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Stephen Asbury">

    <link rel="shortcut icon" href="/static/img/rad_tiny.ico" />
 
    <!-- CSS -->
    <link href='https://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Rokkitt' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=PT+Mono' rel='stylesheet' type='text/css'>
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">
    <link href="/static/css/prettify.css" rel="stylesheet">
    <link href="/static/css/sasbury.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>

  <body>

    <div id="wrap">

      <!-- Begin page content -->
      <div class="container">
        <div class="page-header">
          <h1><a class="homepage" href="/"><img src="/static/img/rad_small.png"> sasbury.com</a></h1>
        </div>

        <div id="content">
           

    <div class="pull-right">
        <a href="/notes/">Back to notebook</a>
    </div>

    <h2>Plug and Play Services and Testing</h2>

    <div>
        <p>I got to thinking...</p>
<p>One of the reasons some people give for having a complete test suite is that it makes it easier to change code. In the case of a microservice architecture I have seen people motivate microservices with the possibility of replacing them based on tests. The idea being that if you have a solid test suite you can re-implement a service safely.</p>
<p>What I have realized is that most of the applications I have been involved with, or read about, the tests are part of the application code base. The issue that I was thinking about is that these tests are usually tied to the implementation either directly or indirectly.</p>
<p>Let's take an example. Suppose I wrote a web service in Java and built a lovely set of tests for it in JUnit. Later, if I decide I want to port the service to Go the JUnit tests are probably not going to work for testing my Go service. Rather, I will have to rebuild them in Go. At least, that is the path I have seen most people go down.</p>
<p>I can think of several solutions for this issue:</p>
<ul>
<li>
<p>Write a set of tests that are true black box tests for your service. These could be written in any framework or language, and must access the service as it will be accessed in production. So for a web service using HTTP, the tests will use an HTTP client library to access it. By creating, what are basically "integration" tests you can test a new service with the same tests as the old service.</p>
<p>This method doesn't preclude having separate unit tests.</p>
</li>
<li>
<p>Rely on client tests. For example, you might use selenium to test your web interface, and then run these on the new and old service implementation. The problem with this mechanism is that it is basically the same as the first solution, but with the client as a mapping between the tests and the server. Basically, too many layers and it requires that the client tests cover every situation.</p>
</li>
<li>
<p>The final idea I had is based on a talk from GopherCon. A speaker from Parse/Facebook was talking about how they rewrote their stack in Go. Part of their testing was to create a shadow cluster of their services running the new versions and compare results between the old and new implementation. Basically requests are sent to both places, and the results are compared for discrepancies. This idea of using real world input to test a new service leaves open some edge cases but could be made very generically. I am thinking that even if you built the tests from bullet one, it would still be useful to implement this step during deployment, before making the new services the ones the client "sees."</p>
</li>
</ul>
<p>So those were my thoughts and possible solutions. I will post again if I get to put these ideas in practice.</p>
    </div>

     
        <div class="post_date_bottom">- Stephen (2015-07-08)</div>
    

    <div>
        

        
            <a href="/tag/architecture/" class="tag">
                architecture
            </a>
        
            <a href="/tag/testing/" class="tag">
                testing
            </a>
        
            <a href="/tag/microservice/" class="tag">
                microservice
            </a>
        

        
    </div>
    
    <div class="pull-right">
        <a href="/notes/">Back to notebook</a>
    </div>


        </div>

      </div>

      <div id="push"></div>
    </div>

    <div id="footer">
      <div class="container">
        <div class="pull-right social">
          
          
          <div class="rss">
            <a href="/notes/sasbury_rss.xml">
              <img src="/static/img/rss.png"/>
            </a>
          </div>

          <div class="github">
            <a href="https://github.com/sasbury">
              <img src="/static/img/github_mark.png"/>
            </a>
          </div>

          <div class="linkedin">
            <a href="http://www.linkedin.com/pub/stephen-asbury/36/230/973">
              <img src="https://static.licdn.com/scds/common/u/img/webpromo/btn_in_20x15.png" width="24" height="18" alt="View Stephen Asbury's LinkedIn profile">
            </a>
          </div>

          <a href="https://twitter.com/thesasbury" class="twitter-follow-button" data-show-count="false">Follow @thesasbury</a>

          <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        <p class="muted credit">Copyright &copy; 2015-2019 Stephen Asbury</p>
      </div>
    </div>

    <script src="/static/js/jquery.js"></script>
    <script src="/static/js/bootstrap.js"></script>
    <script src="/static/js/prettify.js"></script>
    <script src="/static/js/viz.js"></script>
    <script type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <script src="/static/js/sasbury.js"></script>

    <script>
 
    $(document).ready(function() {
        processSpecials();
    });
    </script>
  </body>
</html>